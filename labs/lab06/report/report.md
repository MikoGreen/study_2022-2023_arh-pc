---
## Front matter
title: "Отчёт по лабораторной работе №6"
subtitle: "Архитектура компьютера"
author: "Рогожина Надежда Александровна"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9

## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Приобретение практических навыков работы в Midmight Commander. Освоение инструкций языка ассемблера mov и int. 

# Задание

1. Создайте копию файла lab6-1.asm. Внесите изменения в программу (без использования внешнего файла in_out.asm), так чтобы она работала по следующему алгоритму:

• вывести приглашение типа “Введите строку:”;

• ввести строку с клавиатуры;

• вывести введённую строку на экран;

2. Получите исполняемый файл и проверьте его работу. На приглашение ввести строку введите свою фамилию.

3. Создайте копию файла lab6-2.asm. Исправьте текст программы с использование подпрограмм из внешнего файла in_out.asm, так чтобы она работала по следующему алгоритму:

• вывести приглашение типа “Введите строку:”;

• ввести строку с клавиатуры;

• вывести введённую строку на экран.

4. Создайте исполняемый файл и проверьте его работу.

# Теоретическое введение

## Основы работы с Midnight Commander

Midnight Commander (или просто mc) - это программа, которая позволяет просматривать структуру каталогов и выполнять основные операции по управлению файловой системой, т.е. mc является файловым менеджером, позволяет сделать работу с файлами более удобной и наглядной.



: Функциональные клавиши Midnight Commander {#tbl:std-dir}

| Функциональные клавиши                | Выполняемое действие                                                |
|---------------------------|----------------------------------------------------------------------------------------------------------------------------|
| F1                        | Вызов контекстно-зависимой подсказки                     |
| F2                        | Вызов меню, созданного пользователем     |
| F3                        | Просмотр файла, на который указывает подсветка в активной панели                 |
| F4                        | Вызов встроенного редактора для файла, на который указывает подсветка в активной панели |
| F5                        | Копирование файла или группы отмеченных файлов из каталога, отображаемого в активной панели, в каталог, отображаемый на второй панели                    |
| F6                        | Перенос файла или группы отмеченных файлов из каталога, отображаемого в активной панели, в каталог отображаемый на второй панели                          |
| F7                        | Создание подкаталога в каталоге, отображаемом в активной панели    |
| F8                        | Удаление файла (подкаталога) или группы отмеченных файлов       |
| F9                        | Вызов основного меню программы                       |
| F10                       | Выход из программы         |

## Структура программы на языке ассемблера NASM

Программа на языке ассемблера NASM, как правило, состоит из трёх секций: 

1. секция кода программы (SECTION .text), 

2. секция инициированных (известных во время компиляции) данных (SECTION .data) 

3. секция неинициализированных данных (тех, под которые во время компиляции только отводится память, а значение присваивается в ходе выполнения программы) (SECTION .bss)

## Описание инструкции mov

Инструкция языка ассемблера mov предназначена для дублирования данных источника в приёмнике. В общем виде эта инструкция записывается в виде 

mov dst,src 

Здесь операнд dst — приёмник, а src — источник.

В качестве операнда могут выступать регистры (register), ячейки памяти (memory) и непосредственные значения (const).

## Описание инструкции int

Инструкция языка ассемблера intпредназначена для вызова прерывания с указанным номером. В общем виде она записывается в виде 

int n

Здесь n — номер прерывания, принадлежащий диапазону 0–255.

При программировании в Linux с использованием вызовов ядра sys_calls n=80h (принято задавать в шестнадцатеричной системе счисления).

После вызова инструкции int 80h выполняется системный вызов какой-либо функции ядра Linux. При этом происходит передача управления ядру операционной системы. Чтобы узнать, какую именно системную функцию нужно выполнить, ядро извлекает номер системного вызова из регистра eax. Поэтому перед вызовом прерывания необходимо поместить в этот регистр нужный номер. Кроме того, многим системным функциям требуется передавать какие-либо параметры. По принятым в ОС Linux правилам эти параметры помещаются в порядке следования в остальные регистры процессора: ebx, ecx, edx. Если системная функция должна вернуть значение, то она помещает его в регистр eax.

# Выполнение лабораторной работы

![Прежде всего откроем Midnight Commander](/home/narogozhina/Изображения/Снимки экрана/1.png){ #fig:001 width=70% }

![Перейдем в каталог, созданный при выполнении лабораторной работы №5](/home/narogozhina/Изображения/Снимки экрана/2.png){ #fig:002 width=70% }

![Создадим новый каталог lab06](/home/narogozhina/Изображения/Снимки экрана/3.png){ #fig:003 width=70% }

![Проверим создание каталога](/home/narogozhina/Изображения/Снимки экрана/4.png){ #fig:004 width=70% }

![Перейдем в этот каталог и создадим файл lab06.asm](/home/narogozhina/Изображения/Снимки экрана/5.png){ #fig:005 width=70% }

![Проверим создание файла](/home/narogozhina/Изображения/Снимки экрана/6.png){ #fig:006 width=70% }

![С помощью функциональной клавиши F4 откроем файл lab06-1.asm в редакторе nano](/home/narogozhina/Изображения/Снимки экрана/7.png){ #fig:007 width=70% }

![Введем текст программы из листинга 6.1](/home/narogozhina/Изображения/Снимки экрана/8.png){ #fig:008 width=70% }

![С помощью функиональной клавиши F3 проверим текст программы](/home/narogozhina/Изображения/Снимки экрана/9.png){ #fig:009 width=70% }

Оттранслируем текст программы в объектный файл, а затем выполним компоновку и запустим получившийся исполняемый файл

![Трансляция и компоновка](/home/narogozhina/Изображения/Снимки экрана/10.png){ #fig:010 width=70% }

![Скачаем файл](/home/narogozhina/Изображения/Снимки экрана/11.png){ #fig:011 width=70% }

![Зайдем в папку, куда файл был скачан через mc](/home/narogozhina/Изображения/Снимки экрана/12.png){ #fig:012 width=70% }

![Скопируем файл в каталог с файлов lab06-1.asm с помощью F5](/home/narogozhina/Изображения/Снимки экрана/13.png){ #fig:013 width=70% }

![С помощью F6 создадим копию файла lab6-01.asm c именем lab06-2.asm](/home/narogozhina/Изображения/Снимки экрана/14.png){ #fig:014 width=70% }

![Проверим создание файла](/home/narogozhina/Изображения/Снимки экрана/16.png){ #fig:016 width=70% }

![Исправим текст программы в файле lab06-2.asm](/home/narogozhina/Изображения/Снимки экрана/15.png){ #fig:015 width=70% }

Оттранслируем текст программы в объектный файл, а затем выполним компоновку и запустим получившийся исполняемый файл

![Трансляция и компоновка](/home/narogozhina/Изображения/Снимки экрана/17.png){ #fig:017 width=70% }

![Внесем изменения в текст программы](/home/narogozhina/Изображения/Снимки экрана/19.png){ #fig:019 width=70% }

Оттранслируем текст программы в объектный файл, а затем выполним компоновку и запустим получившийся исполняемый файл

![Трансляция и компоновка](/home/narogozhina/Изображения/Снимки экрана/20.png){ #fig:020 width=70% }

После изменения текста программы, при выполнении программы больше не происходит переноса строки.

# Выполнение заданий для самостоятельной работы

![Создадим копию исходного файла](/home/narogozhina/Изображения/Снимки экрана/21.png){ #fig:021 width=70% }

![Проверим изменение текста программы](/home/narogozhina/Изображения/Снимки экрана/22.png){ #fig:022 width=70% }

![Трансляция и компоновка](/home/narogozhina/Изображения/Снимки экрана/23.png){ #fig:023 width=70% }

Таким образом, после запуска программы, мы удостоверились, что все работает как нужно

![Создадим копию файла lab06-2.asm](/home/narogozhina/Изображения/Снимки экрана/24.png){ #fig:024 width=70% }

![Проверим изменение текста программы](/home/narogozhina/Изображения/Снимки экрана/25.png){ #fig:025 width=70% }

![Трансляция и компоновка](/home/narogozhina/Изображения/Снимки экрана/26.png){ #fig:026 width=70% }

После запуска программы мы убедились, что все работает

# Выводы

Таким образом, по выполнению лабораторной работы мы научились работать с Midnight Commander.

1. MC - это программа, которая позволяет просматривать структуру каталогов и выполнять основные операции по управлению файловой системы. Она упрощает работу с файлами, делает ее более удобной и наглядной.

2. Такие операции как (например) копирование, перемещение, удаление файлов можно выполнить и с помощью bash, и с помощью mc.

3. Типичный формат записи команд NASM имеет вид:

```
[метка:] мнемокод [операнд {, операнд}] [; комментарий]
```

4. Секция bss содержит переменные, для которых **не задано** начальное значение. Секция data содержит переменные, для которых **задано** начальное значение.

5. Для объявления инициированных данных в секции .data используются следующие директивы:

- DB - определяет переменную размером в 1 байт

- DW - определяет переменную размером в 2 байта (слово)

- DD - определяет переменную размером в 4 байта (двойное слово)

- DQ - определяет переменную размером в 8 байт (учетверённое слово)

- DT - определяет переменную размером в 10 байт

6. Инструкция **mov eax, esi** пересылает значение регистра esi в регистр eax.

7. int 80 - вызов ядра.
